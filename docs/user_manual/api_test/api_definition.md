接口定义展示当前项目的所有接口列表、接口用例列表和以文档的形式显示接口信息。
![!接口定义](../../img/api/definition/接口定义.png)

## 接口协议
点击左上角 `HTTP` 下拉框，可切换接口协议，目前支持HTTP、TCP、SQL和DUBBO四种协议。
![!接口协议](../../img/api/definition/接口协议.png)

## 模块树管理
接口定义可以分模块管理，按照测试项目实际功能划分为多级模块进行管理，最多可分八级。鼠标悬浮在模块顶部，点击 `+` 创建一级模块。
![!模块管理](../../img/api/definition/模块管理1.png)

模块支持重命名、添加子模块、删除、展开/收起子模块等操作，选中模块长按鼠标左键可进行拖拽调整。
![!模块管理](../../img/api/definition/模块管理2.png)

支持通过模块名称进行模糊查询。
![!模块管理](../../img/api/definition/模块管理3.png)

## 接口管理
### 接口快捷调试
鼠标悬浮在 `+` 上，点击 `快捷调试` 进入快捷调试页面。
![!快捷操作](../../img/api/definition/快捷调试.png)

填写完整的测试地址和基本请求参数，点击 `测试` 按钮即可进行接口调试。
![!快捷调试](../../img/api/definition/快捷调试1.png)

测试完成后，点击 `另存为新用例` 填写接口CASE名称可以保存为一个新的接口定义和接口CASE。
![!快捷调试](../../img/api/definition/快捷调试2.png)
![!快捷调试](../../img/api/definition/快捷调试3.png)

### 快速创建接口
点击 `更多操作->创建接口` ，可快速创建接口。
![!创建接口](../../img/api/definition/创建接口.png)
![!创建接口](../../img/api/definition/创建接口1.png)

点击 `确定` 按钮即可完成接口定义创建；点击 `编辑详情` 按钮进入接口定义详情页面，可填写基础信息、请求参数、响应内容等信息进行接口定义创建。
![!创建接口](../../img/api/definition/创建接口2.png)

!!! info "说明"
	接口编辑页面由四个功能tab页组成：
	1. `API`：接口定义详情页面
	2. `TEST`：接口的调试信息页面
	3. `CASE`：接口CASE管理页面
	4. `Mock`：接口Mock服务管理页面

### 编辑接口详情
#### API
在API页面中可以对接口的基础信息、请求及响应定义、依赖关系进行详细编辑。
##### 关注接口定义
点击页面右上角的五角星图标，可关注/取消关注该接口定义。
![!关注接口](../../img/api/definition/关注接口.png)

##### 接口变更日志
点击页面右上角的 `变更历史` 可查看此接口所有的变更历史详情。
![!变更历史](../../img/api/definition/变更历史1.png)

点击 `查看详情` 可查看具体变更信息。
![!变更历史](../../img/api/definition/变更历史2.png)

##### HTTP请求
###### 请求头
MeterSphere提供默认请求头变量。
![!HTTP请求头](../../img/api/HTTP请求头1.png)

同时支持批量添加请求头参数。
![!HTTP请求头](../../img/api/HTTP请求头2.png)

点击铅笔图标按钮还可添加 Mock 数据和 JMeter 方法内置函数。
![!HTTP请求头](../../img/api/内置函数.png)

选择Mock数据，点击 `添加函数` 按钮，可添加函数。
![!HTTP请求头](../../img/api/MOCK数据.png)

选择JMeter方法，可查看相关函数。
![!HTTP请求头](../../img/api/JMETER方法.png)

!!! info "说明"
	内置函数的详细说明请参考 [内置函数](./functions.md)

###### QUERY参数
QUERY参数是在接口地址栏中跟在？后面的参数，如updateapi?id=11。
![!QUERY参数](../../img/api/QUERY参数1.png)

点击参数后面的 `高级设置`，可设置参数的其它属性。
![!QUERY参数](../../img/api/QUERY参数2.png)

###### REST参数
REST参数是在接口地址栏中被`/`分隔的参数，如updateapi/{id}。
![!REST参数](../../img/api/REST参数.png)

###### 请求体
请求体参数支持多种形式：form-data，x-www-form-urlencoded，json，xml，raw，binary。
![!HTTP请求体](../../img/api/HTTP请求体1.png)

请求体是form-data和x-www-form-urlencoded格式时，可以选择参数类型。
![!HTTP请求体](../../img/api/HTTP请求体2.png)

不同的参数类型，系统会提供默认属性。
![!HTTP请求体](../../img/api/HTTP请求体3.png)

请求体是Json格式时，系统默认提供两种形式维护Json格式。
![!HTTP请求体](../../img/api/Json格式1.png)

![!HTTP请求体](../../img/api/Json格式2.png)

###### 认证配置
可支持basic auth的认证方式和对数据加密。
![!认证配置](../../img/api/认证配置.png)

###### 其他设置
可设置跟随重定向、连接超时、响应超时时间等。
![!其他设置](../../img/api/其他设置.png)

##### TCP请求
###### 请求参数
请求参数可以在请求模板通过${xxx}引用。
![!TCP请求参数](../../img/api/TCP请求参数.png)

###### 请求体
请求体参数支持json、xml、raw三种数据格式。
![!TCP请求参数](../../img/api/TCP请求体1.png)

其中在xml参数中点击 `添加` 按钮，支持以表格形式添加参数。
![!TCP请求参数](../../img/api/TCP请求体2.png)

xml可添加object、string、arrary三种数据类型的参数。
![!TCP请求参数](../../img/api/TCP请求体3.png)

点击 `保存` 按钮保存添加的xml参数。
![!TCP请求参数](../../img/api/TCP请求体4.png)

###### 前置脚本
请求参数中也支持添加前置脚本。
![!TCP请求参数](../../img/api/TCP前置脚本.png)

###### 其他设置
在其他设置中可设置TCP客户端、连接时间、响应时间等参数。
![!TCP请求参数](../../img/api/其他设置1.png)

TCPClient默认提供三种连接方式。
![!TCP请求参数](../../img/api/其他设置2.png)


##### SQL请求
一个项目支持配置多个数据源，根据接口实际使用场景选择具体数据源。
![!SQL请求参数](../../img/api/SQL请求参数1.png)

存储结果是将返回结果的所有字段存储到一个变量中。
![!SQL请求参数](../../img/api/SQL请求参数4.png)

按列存储直接指定取出返回结果字段的值，列名要和SQL语句中查询返回结果列名对应，同时可以用逗号作为占位符代替列名，只写出要提取的列名即可。
![!SQL请求参数](../../img/api/SQL请求参数2.png)

![!SQL请求参数](../../img/api/SQL请求参数3.png)

##### DUBBO请求
###### Interface
点击 `Get Providers List` 按钮，可从Registry Center中获取服务列表。
![!Interface](../../img/api/Interface1.png)

可在Interfaces下拉列表中选择需要测试的接口及方法，根据该方法的定义，传入所需的参数。
![!Interface](../../img/api/Interface2.png)

![!Interface](../../img/api/Interface3.png)


###### Config Center
可在Config Center中填写配置超时时间、用户名、密码等相关基础信息。
![!ConfigCenter](../../img/api/ConfigCenter.png)

###### Registry Center
可在Registry Center页面中选择协议、填写连接信息等。
![!RegistryCenter](../../img/api/RegistryCenter1.png)

![!RegistryCenter](../../img/api/RegistryCenter2.png)

###### Consumer&Service
可在Consumer中&Service填写Consumer和Service信息。
![!Consumer&Service](../../img/api/Consumer&Service.png)

###### Args
可在Args中添加请求相关参数。
![!Args](../../img/api/Args.png)

###### Attachment Args
可在Attachment Args中设置其他键值对参数。
![!AttachmentArgs](../../img/api/AttachmentArgs.png)

##### 依赖关系设置
接口定义支持设置接口的前后置依赖关系。点击 `添加` 按钮，可以添加前后置接口。
![!依赖关系](../../img/api/依赖关系.png)

#### TEST
在TEST页面中可以调试接口，同时可以添加前后置脚本、前后置SQL、断言、提取参数等子步骤。
##### 针对单个接口发起测试
选择运行环境，点击 `测试` 按钮即可调试接口。
![!测试](../../img/api/测试.png)

!!! info "说明"
	前后置脚本、前后置SQL、断言及参数提取等子步骤的详情说明请参考 [用例步骤说明](./api_step.md)

##### 执行结果
在响应内容中展示响应体、响应头、请求内容、控制台、断言和提取参数等信息。
![!执行结果](../../img/api/执行结果.png)

##### 其他管理功能
点击 `测试` 按钮旁边的向下箭头 `V` ，还提供了加载用例、更新接口等多种快捷功能。
![!其他管理功能](../../img/api/其他管理功能.png)

点击 `加载用例` 加载该接口下的所有用例。
![!加载用例](../../img/api/加载用例.png)
 
点击 `另存为新用例` 可使用该接口页面填写的参数信息及添加的子步骤，创建一个新的接口用例。
![!另存为新用例](../../img/api/另存为新用例.png)

输入用例名称，点击 `保存` 按钮，即可保存为一个新的接口用例。
![!另存为新用例](../../img/api/另存为新用例1.png)

点击 `更新接口` 可将当前页面填写的参数信息更新到对应的接口定义中。
![!更新接口](../../img/api/更新接口.png)

点击 `另存为新的接口` 即可使用当前页面接口信息来创建新的接口定义。
![!另存为新的接口](../../img/api/另存为新接口1.png)

#### CASE
在CASE页面中展示当前接口定义下的所有接口用例列表。
##### 列表功能
支持对接口case的编辑、执行、复制、删除操作。
![!CASE列表功能](../../img/api/CASE列表功能1.png)

鼠标悬浮 `…` 可展示更多隐藏功能：查看引用、执行历史、创建性能测试。
![!CASE列表功能](../../img/api/CASE列表功能2.png)

!!! info "功能说明"
	1. 编辑：编辑该接口用例
	2. 执行：调试该接口
	3. 复制：复制该接口用例信息
	4. 删除：删除该接口用例到回收站
	5. 查看引用：查看该接口用例被场景引用和测试计划引用情况
	6. 执行历史：可查看该接口用例执行历史列表及执行结果详情
	7. 创建性能测试：可使用当前接口用例快速创建性能测试

##### 批量操作
选择多条接口用例，点击 `…` ，可对多个接口用例进行批量操作。
![!CASE批量操作](../../img/api/CASE批量操作.png)

!!! info "批量处理功能说明"
	1. 批量删除：批量删除接口用例到回收站
	2. 批量编辑：批量编辑接口用例属性
	3. 批量执行：批量调试接口用例，运行模式可选择串行或并行，生成报告可选生成独立报告、集合报告。

批量执行CASE生成报告

批量执行接口CASE可以选择生成“独立报告”或“集合报告”了。集合报告将多个接口CASE整合到一个报告中，以方便用户使用，报告展示方式与场景自动化集合报告保持一致。	

![!CASE批量操作](../../img/api/CASE批量操作生成报告1.png)

![!CASE批量操作](../../img/api/CASE批量操作生成报告2.png)



##### 新建接口用例
点击 `+添加` 按钮，可使用当前接口定义填写的参数信息创建新的接口用例。
![!CASE添加](../../img/api/CASE添加.png)

##### 搜索
支持通过接口case的 `ID` 、 `名称` 、 `标签` 进行模糊搜索。
![!CASE搜索](../../img/api/CASE搜索.png)

#### MOCK
在MOCK页面中展示当前接口定义下的MOCK服务。
##### HTTP Mock设置
###### HTTP Mock地址
在接口编辑页面可展示此接口的Mock信息，Mock默认地址是MeterSphere 系统地址+模块 ID+接口地址，一个接口定义可以设置多个Mock服务。
###### Mock服务设置
MeterSphere提供的Mock功能可以根据用户输入的请求参数、返回数据生成Mock接口，这些接口会自动生成模拟数据，以覆盖用户的一些测试需求。而Mock期望则是根据设置的请求触发条件来进行过滤，然后返回期望的数据。

点击 `+添加` 按钮添加Mock服务。
![!新增Mock](../../img/api/新增Mock1.png)

设置Mock服务触发条件
![!触发条件设置](../../img/api/触发条件设置.png)

Mock服务触发条件设置规则匹配及逻辑判断

请求参数新增了规则匹配，可以根据参数设定的值、长度、正则表达式Mock出相应的请求参数，同时参数与参数之间新增了逻辑判断（AND/OR），以提升触发条件的灵活性。
![!触发条件设置](../../img/api/触发条件设置1.png)

针对一些特定测试场景需要对返回信息进一步处理的情况，比如加解密操作、调用第三方JAR包等，MeterSphere在v1.18.0版本中Mock提供了对后置脚本的支持，用户可以通过编写脚本或添加系统已有的自定义代码片段来实现对返回信息的处理。

![!触发条件设置](../../img/api/触发条件设置2.png)


设置Mock服务响应内容。
![!响应内容](../../img/api/响应内容.png)

请求参数与设置的触发条件匹配，则返回设置的响应内容。
![!匹配触发条件](../../img/api/匹配触发条件.png)

![!返回响应内容](../../img/api/返回响应内容.png)

###### 列表功能
支持对Mock服务的开启/关闭、编辑、复制、删除操作。
![!MOCK管理功能](../../img/api/MOCK管理功能.png)

##### TCP Mock设置
###### 开启TCP Mock服务
Mock服务显示未开启，需在 `项目设置->编辑项目` 中开启TCP Mock服务。
![!开启TCP MOCK服务](../../img/api/开启TCPMOCK服务.png)

![!开启TCP MOCK服务](../../img/api/开启TCPMOCK服务1.png)

###### TCP Mock设置
其功能请参考 [HTTP Mock设置](#_46)

### 定时同步
点击 `更多操作->定时同步` 可设置Swagger在线接口文档定时同步。
![!定时同步](../../img/api/定时同步1.png)

设置同步的路径、定时规则等必要定时任务信息，点击 `添加` 按钮完成接口定时同步设置。
![!定时同步](../../img/api/定时同步2.png)

接口定时同步任务支持任务通知。
![!定时同步](../../img/api/定时同步3.png)

定时同步页面支持定时同步任务查看、开启/关闭及删除等操作。
![!定时同步](../../img/api/定时同步4.png)

### 导入接口定义
MeterSphere支持多种类型接口文档的导入，包括：MeterSphere、postman、swagger、har、jmx，点击 `更多操作->导入` 进入接口定义导入页面。
![!接口导入](../../img/api/接口导入1.png)
![!接口导入](../../img/api/接口导入2.png)

Metersphere支持Swagger json文件的离线导入，同时也支持使用swagger URL进行在线同步。
![!接口导入](../../img/api/接口导入3.png)
![!接口导入](../../img/api/接口导入4.png)

### 导出接口定义
MeterSphere支持MeterSphere和Swagger3.0格式的接口API导出，选择要导出的接口，点击 `更多操作->导出` 系统自动完成接口导出。
![!接口导出](../../img/api/接口导出.png)

### 列表功能
支持对接口定义的编辑、执行、用例、删除、复制操作。
![!API列表](../../img/api/API列表功能.png)

!!! info "功能说明"
	1. 编辑：进入 `编辑接口详情->API` 页面
	2. 执行：进入 `编辑接口详情->TEST` 页面
	3. 用例：进入 `编辑接口详情->CASE` 页面
	4. 删除：删除该接口到 `回收站`
	5. 复制：复制该接口定义信息

### 批量操作
选择多条接口定义，点击 `…`，可对多个接口进行批量操作。
![!API列表](../../img/api/API列表批量处理.png)

!!! info "批量处理功能说明"
	1. 批量删除：批量删除接口到回收站
	2. 批量编辑：批量编辑接口属性
	3. 批量移动：批量将接口移动到其他模块
	4. 批量复制：批量将接口复制到其他模块

### 搜索
支持通过接口定义的 `ID` 、 `名称` 、 `标签` 、 `路径` 进行模糊搜索。
![!API列表](../../img/api/API列表搜索.png)

同时也支持多种条件组合搜索。
![!API列表](../../img/api/API列表高级搜索.png)
![!API列表](../../img/api/API列表高级搜索1.png)

### 回收站
回收站展示已删除的接口定义列表。
![!回收站](../../img/api/回收站.png)

!!! info "功能说明"
	1. 恢复：恢复接口到之前的模块
	2. 删除：彻底删除接口

支持批量删除、批量恢复功能。
![!回收站](../../img/api/回收站批量操作.png)

!!! info "批量处理功能说明"
	1. 批量删除：批量删除接口
	2. 批量恢复：批量恢复接口到之前的模块

## 接口用例管理
### 列表功能
支持编辑、执行、复制、删除操作。
![!CASE列表](../../img/api/CASE列表功能3.png)

鼠标悬浮 `…` 可展示更多隐藏功能：查看引用、执行历史、创建性能测试。
![!CASE列表](../../img/api/CASE列表功能4.png)

!!! info "功能说明"
	1. 编辑：编辑该接口用例
	2. 执行：调试该接口
	3. 复制：复制该接口用例信息
	4. 删除：删除该接口用例到回收站
	5. 查看引用：查看该接口用例被场景引用和测试计划引用情况
	6. 执行历史：可查看该接口用例执行历史列表及执行结果详情
	7. 创建性能测试：可使用当前接口用例快速创建性能测试

### 批量操作
选择多条接口CASE，点击 `…` ，可对多个接口CASE进行批量操作。
![!CASE列表](../../img/api/CASE列表批量操作1.png)

!!! info "批量处理功能说明"
	1. 批量删除：批量删除接口用例到回收站
	2. 批量编辑：批量编辑接口用例属性
	3. 批量执行：批量调试接口用例，运行模式可选择串行或并行

### 搜索
支持通过接口CASE的 `ID` 、 `名称` 、 `标签` 进行模糊搜索。
![!CASE列表](../../img/api/CASE列表搜索1.png)

### 回收站
回收站展示已删除的接口CASE列表。
![!回收站](../../img/api/回收站1.png)

!!! info "功能说明"
	1. 恢复：恢复接口CASE到之前的模块
	2. 删除：彻底删除接口CASE

支持批量删除、批量恢复功能。
![!回收站](../../img/api/回收站批量操作1.png)

!!! info "批量处理功能说明"
	1. 批量删除：批量删除接口CASE
	2. 批量恢复：批量恢复接口CASE到之前的模块

## 文档管理
支持以文档形式展示接口定义详细信息，页面右侧展示所有的接口名称列表，点击接口名称定位到该接口详情所在位置。
![!文档](../../img/api/文档.png)

支持接口文档分享功能，点击分享图标按钮，系统会生成接口的URL地址，点击 `复制` 按钮即可将接口的URL地址分享给他人。
![!文档](../../img/api/文档复制.png)
